<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>go2rtc-webviewer</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
</head>
<style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        background-color: #000;
    }

    .cameras-container {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        grid-template-rows: repeat(3, minmax(200px, 1fr));
        gap: 1px;
        background-color: #333;
        height: 100vh;
        padding: 2px;
    }

    video {
        width: 100%;
        height: 100%;
        border: 1px solid #333;
        display: block;
        background-color: #000;
    }

    /* Câmera 1 - ocupa 1x2 (coluna 1, linhas 1-2) */
    .cam-1 {
        grid-column: 1;
        grid-row: 1 / 3;
        object-fit: fill;
    }

    /* Câmera 2 - normal (coluna 2, linha 1) */
    .cam-2 {
        grid-column: 2;
        grid-row: 1;
        object-fit: fill;
    }

    /* Câmera 3 - ocupa 1x2 (coluna 3, linhas 1-2) */
    .cam-3 {
        grid-column: 3;
        grid-row: 1 / 3;
        object-fit: fill;
    }

    /* Câmera 4 - normal (coluna 2, linha 2) */
    .cam-4 {
        grid-column: 2;
        grid-row: 2;
        object-fit: fill;
    }

    /* Câmera 5 - normal (coluna 1, linha 3) */
    .cam-5 {
        grid-column: 1;
        grid-row: 3;
        object-fit: fill;
    }

    /* Câmera 6 - preenche o quadro (coluna 2, linha 3) */
    .cam-6 {
        grid-column: 2;
        grid-row: 3;
        object-fit: fill;
    }

    /* Câmera 7 - preenche o quadro (coluna 3, linha 3) */
    .cam-7 {
        grid-column: 3;
        grid-row: 3;
        object-fit: fill;
    }

    /* Tablet (landscape) */
    @media (max-width: 1024px) and (orientation: landscape) {
        .cameras-container {
            height: 100vh;
            grid-template-rows: repeat(3, 1fr);
        }
    }

    /* Tablet (portrait) */
    @media (max-width: 768px) {
        .cameras-container {
            grid-template-columns: repeat(2, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 1px;
            height: auto;
            min-height: 100vh;
        }

        .cam-1 {
            grid-column: 1;
            grid-row: 1 / 3;
        }

        .cam-2 {
            grid-column: 2;
            grid-row: 1;
        }

        .cam-3 {
            grid-column: 2;
            grid-row: 2;
        }

        .cam-4 {
            grid-column: 1;
            grid-row: 3;
        }

        .cam-5 {
            grid-column: 2;
            grid-row: 3;
            display: none;
        }

        .cam-6 {
            grid-column: 2;
            grid-row: 3;
        }

        .cam-7 {
            display: none;
        }
    }

    /* Mobile */
    @media (max-width: 480px) {
        .cameras-container {
            grid-template-columns: 1fr;
            grid-template-rows: auto;
        }

        .cam-1, .cam-2, .cam-3, .cam-4, .cam-5, .cam-6, .cam-7 {
            grid-column: 1;
            grid-row: auto;
            min-height: 200px;
        }

        .cam-5, .cam-7 {
            display: none;
        }
    }

    /* Timer Panel - Minimalista */
    .timer-panel {
        position: fixed;
        bottom: 10px;
        right: 10px;
        background: rgba(0, 0, 0, 0.9);
        border: 1px solid #555;
        border-radius: 4px;
        padding: 6px 10px;
        z-index: 1000;
        font-family: 'Courier New', monospace;
        font-size: 11px;
        color: #0f0;
    }

    .timer-display {
        display: inline;
        font-weight: bold;
        margin-right: 8px;
    }

    .timer-controls {
        display: inline-flex;
        gap: 4px;
        align-items: center;
    }

    .timer-controls input {
        width: 40px;
        padding: 2px 4px;
        border: 1px solid #555;
        background: #1a1a1a;
        color: #0f0;
        border-radius: 2px;
        font-size: 11px;
        font-family: 'Courier New', monospace;
    }

    .timer-controls button {
        padding: 2px 6px;
        background: #555;
        color: #fff;
        border: none;
        border-radius: 2px;
        cursor: pointer;
        font-size: 11px;
        transition: background 0.2s;
    }

    .layout-select {
        width: 82px;
        padding: 2px 4px;
        border: 1px solid #555;
        background: #1a1a1a;
        color: #0f0;
        border-radius: 2px;
        font-size: 11px;
        font-family: 'Courier New', monospace;
    }

    .timer-controls button:hover {
        background: #777;
    }

    #resetBtn {
        padding: 2px 6px;
        background: #0f0;
        color: #000;
        border: none;
        border-radius: 2px;
        cursor: pointer;
        font-size: 11px;
        font-weight: bold;
        transition: background 0.2s;
    }

    #resetBtn:hover {
        background: #0c0;
    }
</style>
<body>
    <div class="cameras-container">
        <video class="cam-1" src="{{CAM1}}" autoplay muted playsinline></video>
        <video class="cam-2" src="{{CAM2}}" autoplay muted playsinline></video>
        <video class="cam-3" src="{{CAM3}}" autoplay muted playsinline></video>
        <video class="cam-4" src="{{CAM4}}" autoplay muted playsinline></video>
        <video class="cam-5" src="{{CAM5}}" autoplay muted playsinline></video>
        <video class="cam-6" src="{{CAM6}}" autoplay muted playsinline></video>
        <video class="cam-7" src="{{CAM7}}" autoplay muted playsinline></video>
    </div>

    <!-- Timer Panel -->
    <div class="timer-panel">
        <span class="timer-display" id="timerDisplay">{{RESET_MINUTES}}:00</span>
        <div class="timer-controls">
            <input type="number" id="minutesInput" min="1" max="120" value="{{RESET_MINUTES}}">
            <select id="layoutSelect" class="layout-select">
                <option value="1">Layout 1</option>
                <option value="2">Layout 2</option>
            </select>
            <button id="setBtn">✓</button>
            <button id="resetBtn">⟳</button>
        </div>
    </div>
</body>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>

<script>
    // Forçar play dos vídeos ao carregar
    window.addEventListener('load', function() {
        const videos = document.querySelectorAll('video');
        videos.forEach(video => {
            video.play().catch(err => console.log('Autoplay blocked:', err));
        });
    });

    const defaultResetMinutes = parseInt('{{RESET_MINUTES}}', 10) || 15;
    let totalSeconds = defaultResetMinutes * 60;
    let remainingSeconds = totalSeconds;
    let timerInterval;

    const timerDisplay = document.getElementById('timerDisplay');
    const minutesInput = document.getElementById('minutesInput');
    const layoutSelect = document.getElementById('layoutSelect');
    const setBtn = document.getElementById('setBtn');
    const resetBtn = document.getElementById('resetBtn');
    const currentLayout = '{{CURRENT_LAYOUT}}';

    function formatTime(seconds) {
        const mins = Math.floor(seconds / 60);
        const secs = seconds % 60;
        return `${String(mins).padStart(2, '0')}:${String(secs).padStart(2, '0')}`;
    }

    function updateDisplay() {
        timerDisplay.textContent = formatTime(remainingSeconds);
    }

    function startTimer() {
        if (timerInterval) clearInterval(timerInterval);
        
        timerInterval = setInterval(() => {
            remainingSeconds--;
            updateDisplay();
            
            if (remainingSeconds <= 0) {
                clearInterval(timerInterval);
                refreshPage();
            }
        }, 1000);
    }

    function refreshPage() {
        location.reload();
    }

    function resetTimer() {
        clearInterval(timerInterval);
        remainingSeconds = totalSeconds;
        updateDisplay();
        startTimer();
    }

    function setNewTime() {
        const minutes = parseInt(minutesInput.value);
        
        if (isNaN(minutes) || minutes < 1 || minutes > 120) {
            alert('Por favor, insira um valor entre 1 e 120 minutos');
            return;
        }
        
        totalSeconds = minutes * 60;
        resetTimer();
    }

    // Event listeners
    setBtn.addEventListener('click', setNewTime);
    resetBtn.addEventListener('click', resetTimer);
    layoutSelect.value = currentLayout;
    layoutSelect.addEventListener('change', function() {
        const params = new URLSearchParams(window.location.search);
        params.set('layout', layoutSelect.value);
        window.location.search = params.toString();
    });

    // Iniciar timer ao carregar a página
    updateDisplay();
    startTimer();
</script>
</html>